CREATE DATABASE REQUESTOR;
USE REQUESTOR;

CREATE TABLE REQUEST	
(	
	ID INTEGER NOT NULL AUTO_INCREMENT,
	NUM INTEGER NOT NULL UNIQUE,
	LABEL VARCHAR(100) NOT NULL,
	REQ VARCHAR(5000) NOT NULL,

	PRIMARY KEY(ID)
);


CREATE TABLE REQUEST_PARAM	
(	
	ID INTEGER NOT NULL AUTO_INCREMENT,
	IDREQUEST INTEGER NOT NULL,
	NUM INTEGER NOT NULL,
	LABEL VARCHAR(50) NOT NULL,
	HELP VARCHAR(50),

	PRIMARY KEY(ID),
	FOREIGN KEY (IDREQUEST) REFERENCES REQUEST (ID),
	UNIQUE KEY unique_idrequest_num (IDREQUEST, NUM)
);



INSERT INTO REQUEST (NUM, LABEL, REQ)
VALUES (
	10000,
	'Users',
	'SELECT * FROM EXAMPLE_USER'
);



INSERT INTO REQUEST (NUM, LABEL, REQ)
VALUES (
	20000,
	'Users by last name',
	'SELECT * FROM EXAMPLE_USER WHERE UPPER(LASTNAME) = UPPER(''{0}'')'
);

INSERT INTO REQUEST_PARAM (IDREQUEST, NUM, LABEL, HELP)
VALUES ((SELECT MAX(ID) FROM REQUEST), 1, 'LASTNAME', 'XXXXXXXXXX');



-- EXAMPLE
CREATE TABLE EXAMPLE_USER	
(	
	ID INTEGER NOT NULL AUTO_INCREMENT,
	LASTNAME VARCHAR(50),
	FIRSTNAME VARCHAR(50),
	CITY VARCHAR(30),
	PRIMARY KEY(ID)
);

INSERT INTO EXAMPLE_USER (LASTNAME, FIRSTNAME, CITY)
VALUES ('SMITH', 'JOHN', 'NEW YORK');

INSERT INTO EXAMPLE_USER (LASTNAME, FIRSTNAME, CITY)
VALUES ('SMITH', 'CHARLES', 'NEW YORK');

INSERT INTO EXAMPLE_USER (LASTNAME, FIRSTNAME, CITY)
VALUES ('FAVE', 'ESTEBAN', 'PARIS');

INSERT INTO EXAMPLE_USER (LASTNAME, FIRSTNAME, CITY)
VALUES ('TRIUMPH', 'LUCIE', 'LONDON');

